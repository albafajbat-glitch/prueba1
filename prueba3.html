<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Colores del Concierto</title>
  <meta name="theme-color" content="#000000" />
  <style>
    :root{
      /* Colores fijos (ya no hay selector de tono) */
      --azul:#0052cc;
      --amarillo:#fdd72e;
      --gris:#0f172a;
      --gris2:#020203;
      --borde:rgba(255,255,255,.12);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial;background:radial-gradient(1200px 800px at 10% 10%,#1e293b,#0b1020);color:#f8fafc}
    .wrap{max-width:720px;margin:0 auto;padding:24px}

    /* Cabecera centrada */
    header{display:flex;align-items:center;justify-content:center;padding:8px 0}
    .title{font-size:clamp(22px,3vw,28px);font-weight:800;letter-spacing:.3px;text-align:center}

    .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));border:1px solid var(--borde);border-radius:16px;padding:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .grid{display:grid;grid-template-columns:1fr;gap:12px} /* siempre una columna */
    label{font-size:14px;opacity:.9}
    input[type="text"]{width:100%;margin-top:6px;padding:12px 14px;background:#0b1326;border:1px solid var(--borde);border-radius:12px;color:#e5e7eb;outline:none}
    .hint{font-size:12px;color:#94a3b8;margin-top:6px}
    .btn{appearance:none;border:1px solid var(--borde);background:linear-gradient(180deg,#18254a,#0d1430);color:#e5e7eb;padding:14px 16px;border-radius:14px;cursor:pointer;font-weight:700;letter-spacing:.3px;width:100%;transition:transform .05s ease,filter .2s ease}
    .btn:hover{filter:brightness(1.08)}
    .btn:active{transform:translateY(1px)}
    .row{display:flex;gap:10px}
    .row>*{flex:1}
    .preview{height:48px;border-radius:10px;overflow:hidden;border:1px solid var(--borde);display:flex}
    .preview>div:first-child{background:var(--azul);flex:1}
    .preview>div:last-child{background:var(--amarillo);flex:1}
    .mode{display:flex;gap:8px;flex-wrap:wrap}
    .chip{border:1px solid var(--borde);background:rgba(255,255,255,.04);color:#cbd5e1;padding:10px 12px;border-radius:999px;cursor:pointer;user-select:none}
    .chip.active{background:rgba(255,255,255,.12);color:#ffffff;border-color:rgba(255,255,255,.25)}
    .chip-section.active{background:rgba(16,185,129,.18);color:#eafff6;border-color:rgba(16,185,129,.4)}
    footer{margin-top:20px;color:#94a3b8;font-size:12px;text-align:center}

    /* Pantalla de show */
    #show{position:fixed;inset:0;display:none;background:#000}
    #show.showing{display:block}
    .fill{position:absolute;inset:0}
    .half{position:absolute;inset:0}
    .half.left{right:50%;background:var(--azul)}
    .half.right{left:50%;background:var(--amarillo)}
    .flash{animation:blink 1.2s infinite alternate ease-in-out}
    @keyframes blink{from{opacity:1}to{opacity:.2}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">CONCIERTO QUEVEDO-CORUÑA 2025</div>
    </header>

    <div class="card" style="margin-top:14px">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
        <div>
          <div style="font-weight:700;font-size:16px;">Selecciona tu sección:</div>
        </div>
        <div class="preview" aria-hidden="true"><div></div><div></div></div>
      </div>

      <!-- GRADAS -->
      <div class="grid" style="margin-top:12px;">
        <div>
          <label>Sección / Grada</label>
          <input id="section" type="text" placeholder="Ej: Pista, Tendido Alto, ..." />
          <div id="selector-sections" class="mode" aria-label="Selector de sección" style="margin-top:8px;">
            <div class="chip chip-section" data-section="PISTA">PISTA</div>
            <div class="chip chip-section" data-section="TENDIDO BAJO">TENDIDO BAJO</div>
            <div class="chip chip-section" data-section="TENDIDO MEDIO">TENDIDO MEDIO</div>
            <div class="chip chip-section" data-section="TENDIDO ALTO">TENDIDO ALTO</div>
            <div class="chip chip-section" data-section="ANFITEATRO">ANFITEATRO</div>
          </div>
        </div>

        <!-- MODO COLOR (debajo de gradas) -->
        <div>
          <label>Modo de color:</label>
          <div class="mode" role="tablist" aria-label="Modo de color">
            
            <div class="chip" data-mode="fijo-azul">Fijo Azul</div>
            <div class="chip" data-mode="fijo-amarillo">Fijo Amarillo</div>
          </div>
        </div>
      </div>

      <!-- QUITADOS selectores de tono -->

      <div class="row" style="margin-top:16px;">
        <button class="btn" id="start">Activar colores</button>
        <button class="btn" id="stop" style="display:none;">Salir</button>
      </div>

      <p class="hint" style="margin-top:10px;">SUGERENCIA: sube el brillo al máximo.</p>
    </div>

    <footer>Funciona sin internet una vez cargado.</footer>
  </div>

  <!-- Capa show -->
  <div id="show" aria-hidden="true">
    <div id="layer-azul" class="fill" style="background:var(--azul);display:none;"></div>
    <div id="layer-amarillo" class="fill" style="background:var(--amarillo);display:none;"></div>
    <div id="half-left" class="half left" style="display:none;"></div>
    <div id="half-right" class="half right" style="display:none;"></div>
  </div>

  <script>
    const $ = (sel)=>document.querySelector(sel);
    const params = new URLSearchParams(location.search);



    // Elementos
    const sectionInput = $('#section');
    const startBtn = $('#start');
    const stopBtn = $('#stop');
    const show = $('#show');
    const layerAzul = $('#layer-azul');
    const layerAmarillo = $('#layer-amarillo');
    const halfLeft = $('#half-left');
    const halfRight = $('#half-right');

    // Sección desde URL
    const sectionFromURL = params.get('section') || params.get('seccion') || '';
    if (sectionFromURL) sectionInput.value = sectionFromURL;

    // Chips de modo
    document.querySelectorAll('.chip[data-mode]').forEach(chip=>{
      chip.addEventListener('click', ()=>{
        document.querySelectorAll('.chip[data-mode]').forEach(c=>c.classList.remove('active'));
        chip.classList.add('active');
        mode = chip.dataset.mode;
      });
    });

    // Selector rápido de secciones
    document.querySelectorAll('.chip-section').forEach(ch=>{
      ch.addEventListener('click', ()=>{
        const sec = ch.dataset.section;
        sectionInput.value = sec;
        document.querySelectorAll('.chip-section').forEach(c=>c.classList.remove('active'));
        ch.classList.add('active');
      });
    });

    // Fullscreen helpers
    async function enterFullscreen(){
      const el=document.documentElement;
      if(el.requestFullscreen) await el.requestFullscreen();
      else if(el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
    }
    async function exitFullscreen(){
      if(document.fullscreenElement) await document.exitFullscreen();
      else if(document.webkitFullscreenElement) await document.webkitExitFullscreen();
    }

    // Wake Lock
    async function requestWakeLock(){
      try{
        if('wakeLock' in navigator){
          wakeLock = await navigator.wakeLock.request('screen');
          wakeLock.addEventListener('release',()=>console.log('Wake Lock liberado'));
        }
      }catch(e){ console.warn('Wake Lock no disponible', e); }
    }
    async function releaseWakeLock(){ try{ if(wakeLock){ await wakeLock.release(); wakeLock=null; } }catch{} }

    // Render de modos
    function renderMode(){
      layerAzul.style.display='none';
      layerAmarillo.style.display='none';
      halfLeft.style.display='none';
      halfRight.style.display='none';
      layerAzul.classList.remove('flash');
      layerAmarillo.classList.remove('flash');

      if(mode==='mitad'){
        halfLeft.style.display='block';
        halfRight.style.display='block';

      }else if(mode==='fijo-azul'){
        layerAzul.style.display='block';
      }else if(mode==='fijo-amarillo'){
        layerAmarillo.style.display='block';
      }
    }

    // Inicio/Fin
    startBtn.addEventListener('click', async ()=>{
      const section=(sectionInput.value||'').trim();
      if(section){
        const url=new URL(location.href);
        url.searchParams.set('section', section);
        history.replaceState(null,'',url);
      }
      await enterFullscreen();
      await requestWakeLock();
      renderMode();
      show.classList.add('showing');
      startBtn.style.display='none';
      stopBtn.style.display='inline-block';
    });

    stopBtn.addEventListener('click', async ()=>{
      show.classList.remove('showing');
      await releaseWakeLock();
      await exitFullscreen();
      startBtn.style.display='inline-block';
      stopBtn.style.display='none';
    });

    document.addEventListener('fullscreenchange', ()=>{
      if(!document.fullscreenElement){
        show.classList.remove('showing');
        releaseWakeLock();
        startBtn.style.display='inline-block';
        stopBtn.style.display='none';
      }
    });
  </script>
</body>
</html>
